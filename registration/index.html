<!DOCTYPE html>
<html>
  <head>
    <title>Inscrição - Cursos de Curta Duração do BioME</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href="http://fonts.googleapis.com/css?family=Lato:300,400,400italic,600,700|Raleway:300,400,500,600,700|Crete+Round:400italic" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="css/mine/style.css" type="text/css" />
    <link rel="stylesheet" href="css/mine/fix.css" type="text/css" />
    <link rel="stylesheet" href="css/swiper.css" type="text/css" />
    <link rel="stylesheet" href="css/dark.css" type="text/css" />
    <link rel="stylesheet" href="css/font-icons.css" type="text/css" />
    <link rel="stylesheet" href="css/animate.css" type="text/css" />
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />
    <link rel="stylesheet" href="css/responsive.css" type="text/css" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

  <link rel="shortcut icon" type="image/png" href="images/logos/logocursos.png"/>
  <style>
    body {
    padding-top: 40px;
    padding-bottom: 40px;
    background-color: #eee;
    }
    .form-signin {
    max-width: 330px;
    padding: 15px;
    margin: 0 auto;
    }
    .form-signin .form-signin-heading,
    .form-signin .checkbox {
    margin-bottom: 10px;
    }
    .form-signin .checkbox {
    font-weight: normal;
    }
    .form-signin .form-control {
    position: relative;
    height: auto;
    -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
            box-sizing: border-box;
    padding: 10px;
    font-size: 16px;
    }
    .form-signin .form-control:focus {
    z-index: 2;
    }
    .form-signin input[type="email"] {
    margin-bottom: -1px;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
    }
    .form-signin input[type="password"] {
    margin-bottom: 10px;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
    }
    .form-signin input[type="email"] {
        margin-bottom: 10px;
    }
    .tab-content.form-signin{
        background-color: #fff;
        border: 1px solid #ddd;
        border-top:0;
    }
    img.logo {
        display: block;
        margin: auto;
        width: 750px;
        height: : 750px;
        margin-bottom: 20px;
    }
    .tab-content form-signin {
        background-color: #FFF;
        border: 1px solid #DDD;
        border-top: none;
    }
    fieldset.form-group {
        margin-top:10px;
        margin-bottom:0px;
    }
    .no-padding {
        padding: 0;
    }
    .content-row .content-col {
        background-color: #FFF;
        padding: 30px 15px 15px 15px;
        border: 1px solid #DDD;
        border-top: none;
    }
    form small {
        display: block;
        margin-bottom: 10px;
    }
    .info-row [class*="col-"]{
        padding: 1.5em;
        background-color: #FFF;
        border: 1px solid #DDD;
        border-top: none;
        border-bottom: none;
    }
    .container .info-row:last-of-type [class*="col-"]{
        border-bottom: 1px solid #DDD;
        padding-top: 0;
    }
    .container .info-row:first-of-type [class*="col-"]{
        padding-bottom:0px;
    }
    #login-container, #info-container {
        display: none;
    }
    .alert:last-of-type {
        margin-bottom: 0px;
    }
    .alert {
        display: none;
    }
    #psForm {
        margin: 50px 0px 35px 0px;
        text-align: center;
    }
    #psForm p, #psForm span {
        text-align: center; font-size: 1.25em;
    }
    #psForm input {
        margin-top: 25px;
    }
    #abstract-view p {
        text-align: center;
        padding-right: 50px;
        padding-left: 50px;
        margin: 0 0 30px;
    }
    #abstract-view #title {
        font-weight: 900;
    }
    #abstract-view #text {
        text-align: justify;
    }
    #abstract-view #keywords {
        text-align: left;
    }
    #abstract-form, #abstract-view {
        display: none;
    }
    /* nav fix */
    .nav-tabs>li {
        height:62px;
    }
    .nav-tabs>li>a, .nav-tabs>li>a>div {
        height:100%;
        display:table;
    }
    .nav-tabs>li>a span {
        display:table-cell;
        vertical-align:middle;
    }
    li[role="presentation"] a {
        width: 100%;
    }
    .professional, .non-professional{
        display: none;
    }
  </style>
  </head>

  <body>

    <div class="container">
        <!--<a href="../">-->
            <img class="logo" src="images/logos/logocursos.png"/>

       <!-- <section id="page-title" class="page-title-parallax page-title-dark" style="padding: 150px 0; background-image: url('images/landing/back2.png'); background-size: cover; background-position: center center;" data-stellar-background-ratio="0.4">

                <div class="dark">
                    <div class="slider-caption slider-caption-center">
                        <h2 id="firebase-eventInfo-title" data-caption-animate="fadeInUp" style="font-weight: 400;">Cursos de curta duração 2017</h2>
                        <div id="col" class="team-container center" style="margin-top: 75px">
                            <div>
                                <p style="font-size: 40px; font-weight: 700;">BioME - Centro Multiusuário de Bioinformática - UFRN</p>
                            </div>
                        </div>
                    </div>
                </div>

        </section>--><!-- #page-title end -->
        <br><br>

        <!--</a>-->
    </div>

    <div class="container" id="login-container">

        <div class="row">

                <!-- Nav tabs -->
                <ul class="nav nav-tabs form-signin no-padding nav-justified" role="tablist" style="padding-bottom:0px;">
                    <li role="presentation" class="active"><a href="#register" aria-controls="home" role="tab" data-toggle="tab"><h4>Cadastro</h4></a></li>
                    <li role="presentation"><a href="#signin" aria-controls="signin" role="tab" data-toggle="tab"><h4>Login</h4></a></li>
                    <li role="presentation"><a href="#reset" aria-controls="reset" role="tab" data-toggle="tab"><h4>Alterar Senha</h4></a></li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content form-signin">

                    <div role="tabpanel" class="tab-pane active" id="register">
                        <form id="registerForm" class="form-signin" name="register">
                            <label for="inputEmail" class="sr-only">Email</label>
                            <input type="email" id="inputEmailRegister" name="inputEmailRegister" class="form-control" placeholder="Email" required autofocus="">
                            <label for="inputPassword" class="sr-only">Senha</label>
                            <input type="password" id="inputPasswordRegister" name="inputPasswordRegister" class="form-control" placeholder="Senha" required>
                            <small id="passwordHelp" class="form-text text-muted">A senha deve ter no mínimo 6 caracteres</small>
		                    <label for="confirmPassword" class="sr-only">Confirmar Senha</label>
                            <input type="password" id="confirmPassword" class="form-control" placeholder="Confirmar Senha" required>
                            <button id="registerBtn" class="btn btn-lg btn-primary btn-block" type="submit">Cadastrar</button>
                        </form>
                    </div>

                    <div role="tabpanel" class="tab-pane" id="signin">
                        <form id="signInForm" class="form-signin" name="signin">
                            <label for="inputEmail" class="sr-only">Email</label>
                            <input type="email" id="inputEmailSignIn" name="inputEmailSignIn" class="form-control" placeholder="Email" required autofocus>
                            <label for="inputPassword" class="sr-only">Senha</label>
                            <input type="password" id="inputPasswordSignIn" name="inputPasswordSignIn" class="form-control" placeholder="Senha" required>
                            <button id="signinBtn" class="btn btn-lg btn-primary btn-block" type="submit">Login</button>
                        </form>
                    </div>

                    <div role="tabpanel" class="tab-pane" id="reset">
                        <form id="signInForm" class="form-signin" name="reset">
                            <label for="inputEmail" class="sr-only">Email</label>
                            <input type="email" id="inputEmailReset" name="inputEmailReset" class="form-control" placeholder="Email" required autofocus>
                            <button id="resetBtn" class="btn btn-lg btn-primary btn-block" type="submit">Solicitar Alteração</button>
                        </form>
                    </div>

            </div>
        </div>
    </div>

    <!--                -->
    <!-- info-container -->
    <!--                -->
    <div class="container" id="info-container">

        <div class="row">
            <div class="no-padding col-md-10 col-md-offset-1 col-xs-10 col-xs-offset-1 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2">
                <!-- Nav tabs -->
                <ul id="signed-tab" class="nav nav-tabs nav-justified" role="tablist" style="padding-bottom:0px; margin: 0 auto 0 0;">
                    <!--<li role="presentation" class="active"><a href="#info" aria-controls="info" role="tab" data-toggle="tab"><h4>General Info</h4></a></li>-->
                    <li role="presentation" class="active"><a href="#data" aria-controls="data" role="tab" data-toggle="tab"><h4>Dados</h4></a></li>
                   <!-- <li role="presentation" id="abstractTab"><a href="#abstract" aria-controls="abstract" role="tab" data-toggle="tab"><h4>Abstract</h4></a></li>-->
                    <li role="presentation"><a href="#payment" aria-controls="payment" role="tab" data-toggle="tab"><h4>Pagamento</h4></a></li>
                    <li role="presentation" id="logOutTab"><a href="#" aria-controls="logout" role="tab" data-toggle="tab"><h4>Sair</h4></a></li>
                    <!--<button id="logOutBtn" class="btn btn-danger pull-right" style="margin-top: 12px">Log Out</button>-->
                </ul>
            </div>
        </div>

        <div class="row info-row">
            <div class="col-md-10 col-md-offset-1 col-xs-10 col-xs-offset-1 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2">
                <div class="alert alert-warning" role="alert"><strong>Atenção:</strong> Pagamento Pendente</div>
                <div id="update-success" class="alert alert-success" role="alert">Informação atualizada com sucesso!</div>
                <div id="payment-success" class="alert alert-success" role="alert">Pagamento confirmado!</div>
                <div class="alert alert-danger" role="alert"><strong>Erro:</strong> Algo deu errado!</div>
            </div>
        </div>

        <div class="row content-row info-row">

            <div class="content-col col-md-10 col-md-offset-1 col-xs-10 col-xs-offset-1 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2">

                <!-- Tab content -->
                <div class="tab-content">

                    <!-- tab pane 1 -->
                    <!--
                    <div role="tabpanel" class="tab-pane active" id="info">
                        <p id="oral-countdown" style="font-size: 1.5em;"></p>
                        <p>Left to opt for oral contribution</p>
                        <hr>
                        <p id="poster-countdown" style="font-size: 1.5em;"></p>
                        <p>Left to opt for poster presentation</p>
                        <hr>
                        <p id="db-info"></p>
                    </div>
                    -->


                    <!-- tab pane 2 -->
                    <div role="tabpanel" class="tab-pane active" id="data">
                        <form id="data-form">
                            <div class="form-group">
                                <label for="inputName">Nome Completo</label>
                                <input type="text" class="form-control" id="inputName" placeholder="Informe seu nome">
                            </div>
                            <div class="form-group">
                                <label for="inputPhone">Telefone</label>
                                <input type="text" class="form-control" id="inputPhone" placeholder="Informe seu número para contato">
                            </div>
                            <div class="col-md-8 form-group">
                                <label for="inputCity">Cidade</label>
                                <input type="text" class="form-control" id="inputCity" placeholder="Informe a sua cidade">
                            </div>
                            <div class="col-md-4 form-group">
                                <label for="inputUF">UF</label>
                                <select class="form-control" id="inputUF" placeholder="UF">
                                    <option selected disabled>Selecione o seu estado</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="inputEnrollment">Categoria</label>
                                <select class="form-control" id="inputEnrollment" placeholder="Categoria de inscrição">
                                    <option selected disabled>Selecione sua categoria</option>
                                </select>
                            </div>

                             <div class="form-group non-professional">
                                <label for="inputInstitution">Instituição</label>
                                <input type="text" class="form-control" id="inputInstitution" placeholder="Informe sua instituição de ensino">
                            </div>
                            <div class="col-md-6 form-group non-professional">
                                <label for="inputCourse">Curso</label>
                                <input type="text" class="form-control" id="inputCourse" placeholder="Informe seu curso">
                            </div>
                            <div class="col-md-6 form-group non-professional">
                                <label for="inputDepartment">Departamento</label>
                                <input type="text" class="form-control" id="inputDepartment" placeholder="Informe seu departamento">
                            </div>

                            <div class="col-md-6 form-group professional">
                                <label for="inputCompany">Empresa</label>
                                <input type="text" class="form-control" id="inputCompany" placeholder="Informe o nome da sua empresa">
                            </div>
                            <div class="col-md-6 form-group professional">
                                <label for="inputOffice">Cargo</label>
                                <input type="text" class="form-control" id="inputOffice" placeholder="Informe seu cargo na empresa">
                            </div>

                            <label>POR FAVOR, CONFIRME SUA INSCRIÇÃO NO(S) CURSO(S) </label>
                            <div class="form-check">
                                <label class="form-check-label">
                                <input id="inputNGS" type="checkbox" class="form-check-input">
                                Análise de Dados de Sequenciadores de Segunda Geração
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                <input id="inputProteomica" type="checkbox" class="form-check-input">
                                Análise Proteômica - Conceitos e Aplicações
                                </label>
                            </div>
                             <div class="form-check">
                                <label class="form-check-label">
                                <input id="inputFilogenia" type="checkbox" class="form-check-input">
                                Filogenia Molecular e Análise Evolucionária de Sequências
                                </label>
                            </div>
                            <fieldset class="form-group">
                                <legend></legend>
                                <button type="submit" class="btn btn-primary pull-right">Submit</button>
                            </fieldset>
                        </form>

                        <center><br><br>
                                <div style="width: 82%; border-style: dotted; padding: 15px;">
                                        <label>Inscreva-se também nos demais cursos de curta duração oferecidos pelo BioME</label><br><br>
                                        <a style="color: #333;" href="http://bioinfo.imd.ufrn.br/cursosdcd/filogenia/index.html">Filogenia Molecular e Análise Evolucionária de Sequências </a><br><br>
                                        <a style="color: #333;" href="http://bioinfo.imd.ufrn.br/cursosdcd/ngs/index.html"> Análise de Dados de Sequenciadores de Segunda Geração </a><br><br>
                                        <p style="color: #FF6347; font-size: 17px;" >Inscritos em dois ou três cursos de curta duração de 2017, receberão um <b>voucher de 20%</b> para eventos futuros do BioME. <br>
                                        (O voucher será enviado para o email cadastrado após conferência dos dados de inscrição)
                                        </p>
                                </div>
                               </center>

                    </div>


                    <!-- tab pane 3 -->
                    <!--
                    <div role="tabpanel" class="tab-pane" id="abstract">
                        <form id="abstract-form">
                            <div class="form-group">
                                <label for="inputTitle">Title</label>
                                <input type="text" class="form-control" id="inputTitle" placeholder="Enter the title of your work">
                            </div>
                            <div class="form-group">
                                <label for="inputAuthors">Authors</label>
                                <input type="text" class="form-control" id="inputAuthors" placeholder="Enter the name of the authors, semicolon separated">
                            </div>
                            <div class="form-group">
                                <label for="inputInstitutions">Institutions</label>
                                <input type="text" class="form-control" id="inputInstitutions" placeholder="Enter the name of the institutions, semicolon separated">
                            </div>
                            <div class="form-group">
                                <label for="inputKeywords">Keywords</label>
                                <input type="text" class="form-control" id="inputKeywords" placeholder="Enter keywords, comma separated">
                            </div>
                            <div class="form-group">
                                <label for="inputText">Abstract</label>
                                <small>2000 character limit</small>
                                <textarea class="form-control" id="inputText" rows="10" maxlength="2000"></textarea>
                            </div>
                            <fieldset class="form-group">
                                <legend></legend>
                                <button type="submit" class="btn btn-primary pull-right">Submit</button>
                            </fieldset>
                        </form>
                        <div id="abstract-view">
                            <p id="title"></p>
                            <p id="authors"></p>
                            <p id="institutions"></p>
                            <p id="text"></p>
                            <p id="keywords"></p>
                            <fieldset class="form-group" id="alterBtn">
                                <legend></legend>
                                <button class="btn btn-primary pull-right">Alter abstract</button>
                            </fieldset>
                        </div>
                    </div>
                    -->

                    <!-- tab pane 4 -->
                    <div role="tabpanel" class="tab-pane" id="payment">
                     <center><br><br>
                                <div style="width: 90%; border-style: dotted; padding: 15px;">
                                        <p>
                                        Clique na imagem a seguir para ser redirecionado para a página de pagamento do PagSeguro. <br>
                                        Sua inscrição somente será efetivada após conferência do pagamento e será confirmada via e-mail. <br>
                                        O status do pagamento será atualizado assim que for notificado. <br>
                                        <b>Nota:</b> Mesmo após realização do pagamento, seu status será atualizado em até <b>2 dias úteis</b>.
                                        </p>
                                </div>
                               </center>
                        <!--
                        <form id="psForm" action="https://pagseguro.uol.com.br/checkout/v2/payment.html" method="post">
                            <p id="description"></p>
                            <span>Taxa de inscrição: R$</span>
                            <span id="fee"></span>
                            <br/>
                            <input type="hidden" name="code" id="productId" value="" />
                            <input type="hidden" name="iot" value="button" />
                            <input type="image" src="https://stc.pagseguro.uol.com.br/public/img/botoes/pagamentos/209x48-comprar-preto-assina.gif" name="submit" alt="Pague com PagSeguro - é rápido, grátis e seguro!" />
                        </form>
                        -->
                        <form id="psForm" target="pagseguro" method="post" action="https://pagseguro.uol.com.br/checkout/checkout.jhtml">
                          <input type="hidden" name="email_cobranca" value="pagseguro@i2bio.org">
                          <input type="hidden" name="tipo" value="CP">
                          <input type="hidden" name="moeda" value="BRL">

                          <div id="cart">
                          <!--
                              <input type="hidden" name="item_id_1" value="12345">
                              <input type="hidden" name="item_descr_1" value="Descrição do item a ser vendido">
                              <input type="hidden" name="item_quant_1" value="1">
                              <input type="hidden" name="item_valor_1" value="100">
                          -->
                          </div>

                          <input type="image" src="https://p.simg.uol.com.br/out/pagseguro/i/botoes/pagamentos/99x61-pagar-assina.gif" name="submit" alt="Pague com PagSeguro - é rápido, grátis e seguro!">
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <a href="http://bioinfo.imd.ufrn.br/outreach/events/">
        <p style="margin-top:50px; text-align: center; color: #FF6347;">Voltar para a página inicial</p>
        </a>
    </div>

    <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
<script>

  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCbwpbytQmv4_7yHIhzGhz9X3xNGKViS90",
    authDomain: "cpap-f3dd0.firebaseapp.com",
    databaseURL: "https://cpap-f3dd0.firebaseio.com",
    projectId: "cpap-f3dd0",
    storageBucket: "cpap-f3dd0.appspot.com",
    messagingSenderId: "401123786472"
  };
  firebase.initializeApp(config);
  // Finish Firebase
</script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script>
    $(document).ready(function() {
        // $('#login-container form').submit(function(e){
        $('form:not(#psForm)').submit(function(e){
            e.preventDefault();
        });

/*
        $('#alterBtn button').click(function(e){
            $('#abstract-view').hide();
            $('#abstract-form').show();
        });
*/

        $('#data-form').submit(function(){
            var name = $(this).find('#inputName').val();
            var phone = $(this).find('#inputPhone').val();
            var city = $(this).find('#inputCity').val();
            var course = $(this).find('#inputCourse').val();
            var institution = $(this).find('#inputInstitution').val();
            var department = $(this).find('#inputDepartment').val();
            var company = $(this).find('#inputCompany').val();
            var office = $(this).find('#inputOffice').val();

            var statte = $(this).find('#inputState').val();
            var uf = $(this).find('#inputUF').val();
            var enrollment = $(this).find('#inputEnrollment').val();
            var ngs = $(this).find('#inputNGS').prop('checked');
            var proteomica = $(this).find('#inputProteomica').prop('checked');
            var filogenia = $(this).find('#inputFilogenia').prop('checked');

            setUserData({
                name: name,
                phone: phone,
                city: city,
                course: course,
                institution: institution,
                department: department,
                company: company,
                office: office,
                uf: uf,
                enrollment: enrollment,
                ngs: ngs,
                proteomica: proteomica,
                filogenia: filogenia
            });
        });

/*
        $('#abstract-form').submit(function(){
            var title = $(this).find('#inputTitle').val();
            var authors = $(this).find('#inputAuthors').val();
            var institutions = $(this).find('#inputInstitutions').val();
            var keywords = $(this).find('#inputKeywords').val();
            var text = $(this).find('#inputText').val();

            setAbstractData({
                title: title,
                authors: authors,
                institutions: institutions,
                keywords : keywords,
                text: text
            });
        });
*/

        $('#registerBtn').click(function(){
            var email = $('#inputEmailRegister').val();
            var password = $('#inputPasswordRegister').val();
            var confirmPassword = $('#confirmPassword').val();
            if(password == confirmPassword){
                firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {
                    console.log(error.message);
    		        alert(error.message);
                });
            } else {
                alert("Senhas não conferem");
            }
        });

        $('#signinBtn').click(function(){
            var email = $('#inputEmailSignIn').val();
            var password = $('#inputPasswordSignIn').val();
            firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {
            console.log(error.message);
            alert(error.message);
                });
        });

        $('#resetBtn').click(function(){
            var email = $('#inputEmailReset').val();
            firebase.auth().sendPasswordResetEmail(email).then(function() {
                alert("E-mail de redefinição de senha enviado.");
            }, function(error) {
                alert(error);
            });
        });

        $('#logOutBtn').click(function(){
            firebase.auth().signOut();
        });

        $('#logOutTab').click(function(){
            if (confirm("Você está prestes a sair."))
                firebase.auth().signOut();
        });

        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                signIn(user);

                firebase.database().ref('users/' + user.uid + '/profile').on('value', function(snapshot) {
                    if(snapshot.val() !== null)
                        updateProfileFields(snapshot.val());
                });

                firebase.database().ref('users/' + user.uid + '/paid').on('value', function(snapshot) {
                    updatePaymentAlert(snapshot.val());
                });

/*
                firebase.database().ref('abstracts/' + user.uid).on('value', function(snapshot) {
                    if(snapshot.val() !== null)
                        updateAbstractFields(snapshot.val());
                });
*/

            } else {
                signOut();
            }
        });

        function signIn(user){
            $('#login-container').hide();
            $('#info-container').show();
        }

        function signOut(){
            $('#info-container').hide();
            $('#login-container').show();
            $('#login-container form').trigger('reset');
        }

        function setUserData(data) {
            var user = firebase.auth().currentUser;

            if (user != null) {
                firebase.database().ref('users/' + user.uid + '/profile').set(data)
                .then(function() {
                    successAlert();
                })
                .catch(function(error) {
                    console.log(error);
                    errorAlert();
                });
            }
        }
/*
        function setAbstractData(data) {
            var user = firebase.auth().currentUser;

            if (user != null) {
                firebase.database().ref('abstracts/' + user.uid).set(data)
                .then(function() {
                    successAlert();

                })
                .catch(function(error) {
                    console.log(error);
                    errorAlert();
                });
            }
        }
*/

        function updateProfileFields(snapshot){
            //user profile
            $('#data-form #inputName').val(snapshot.name);
            $('#data-form #inputPhone').val(snapshot.phone);
            $('#data-form #inputCity').val(snapshot.city);
            $('#data-form #inputCourse').val(snapshot.course);
            $('#data-form #inputInstitution').val(snapshot.institution);
            $('#data-form #inputDepartment').val(snapshot.department);
            $('#data-form #inputCompany').val(snapshot.company);

            $('#data-form #inputNGS').prop('checked', snapshot.ngs);
            $('#data-form #inputProteomica').prop('checked', snapshot.proteomica);
            $('#data-form #inputFilogenia').prop('checked', snapshot.filogenia);

            $('#data-form #inputState option[value="' + snapshot.state + '"]').prop('selected', true);
            $('#data-form #inputUF option[value="' + snapshot.uf + '"]').prop('selected', true);

            $('#data-form #inputEnrollment option[value="' + snapshot.enrollment + '"]').prop('selected', true);
            $('#data-form #inputUF option[value="' + snapshot.uf + '"]').prop('selected', true);

            firebase.database().ref('info/enrollment/' + snapshot.enrollment).once('value').then(function(enrollmentSnapshot) {
                if(enrollmentSnapshot.val().professional){
                    $('.non-professional').hide();
                    $('.professional').show();
                } else{
                    $('.non-professional').show();
                    $('.professional').hide();
                }
                $('#psForm #description').text(enrollmentSnapshot.val().title);
            });

            $('#cart').html('');

            var itemCount = 1;
            if(snapshot.ngs){
                firebase.database().ref('info/enrollment_course/ngs/' + snapshot.enrollment).once('value').then(function(enrollmentCourseSnapshot) {
                    $('#psForm #fee').text(enrollmentCourseSnapshot.val().price);
                    //$('#psForm #productId').val(enrollmentCourseSnapshot.val().productID);
                    $('#cart').append(
                        '<input type="hidden" name="item_id_'+itemCount+'" value="1">' +
                        '<input type="hidden" name="item_descr_'+itemCount+'" value="2Bio: Análise de Dados de Sequenciadores de Segunda Geração">' +
                        '<input type="hidden" name="item_quant_'+itemCount+'" value="1">' +
                        '<input type="hidden" name="item_valor_'+itemCount+'" value="'+enrollmentCourseSnapshot.val().price+'">'
                    );
                    itemCount++;
                });
            }if(snapshot.proteomica){
                firebase.database().ref('info/enrollment_course/proteomica/' + snapshot.enrollment).once('value').then(function(enrollmentCourseSnapshot) {
                    $('#psForm #fee').text(enrollmentCourseSnapshot.val().price);
                    //$('#psForm #productId').val(enrollmentCourseSnapshot.val().productID);
                     $('#cart').append(
                        '<input type="hidden" name="item_id_'+itemCount+'" value="2">' +
                        '<input type="hidden" name="item_descr_'+itemCount+'" value="2Bio: Análise proteômica - conceitos e aplicações">' +
                        '<input type="hidden" name="item_quant_'+itemCount+'" value="1">' +
                        '<input type="hidden" name="item_valor_'+itemCount+'" value="'+enrollmentCourseSnapshot.val().price+'">'
                    );
                    itemCount++;
                });
            }if(snapshot.filogenia){
                firebase.database().ref('info/enrollment_course/filogenia/' + snapshot.enrollment).once('value').then(function(enrollmentCourseSnapshot) {
                    $('#psForm #fee').text(enrollmentCourseSnapshot.val().price);
                    //$('#psForm #productId').val(enrollmentCourseSnapshot.val().productID);
                     $('#cart').append(
                        '<input type="hidden" name="item_id_'+itemCount+'" value="3">' +
                        '<input type="hidden" name="item_descr_'+itemCount+'" value="2Bio: Filogenia Molecular e Análise Evolucionária de Sequências">' +
                        '<input type="hidden" name="item_quant_'+itemCount+'" value="1">' +
                        '<input type="hidden" name="item_valor_'+itemCount+'" value="'+enrollmentCourseSnapshot.val().price+'">'
                    );
                    itemCount++;
                });
            }

        }

        function updatePaymentAlert(snapshot){
            // payment alert
            if(snapshot != 1){
                $("#payment-success").hide();
                $(".alert-warning").slideDown("fast");
            }
            else {
                $(".alert-warning").hide();
                $("#payment-success").slideDown("fast");
            }
        }

/*
        function updateAbstractFields(snapshot){

            var emptyFieldCount = 0;
            for(var teste in snapshot) {
                emptyFieldCount += $.trim(snapshot[teste]) === "";
            }

            if(emptyFieldCount > 0){
                //abstract-form
                $('#abstract-view').hide();
                $('#abstract-form').show();
            } else {
                //abstract-view
                $('#abstract-form').hide();
                $('#abstract-view').show();
            }

            console.log(emptyFieldCount);
            //abstract-form
            $('#abstract-form #inputTitle').val(snapshot.title);
            $('#abstract-form #inputAuthors').val(snapshot.authors);
            $('#abstract-form #inputInstitutions').val(snapshot.institutions);
            $('#abstract-form #inputKeywords').val(snapshot.keywords);
            $('#abstract-form #inputText').val(snapshot.text);

            //abstract-view
            $('#abstract-view #title').text(snapshot.title);
            $('#abstract-view #authors').text(snapshot.authors);
            $('#abstract-view #institutions').text(snapshot.institutions);
            $('#abstract-view #text').text(snapshot.text);
            $('#abstract-view #keywords').text('Keywords: '+snapshot.keywords);
        }
*/

        function successAlert() {
            $("#update-success").slideDown("fast");

            setTimeout(function() {
                $("#update-success").slideUp(500, function() {
                    $(this).hide();
                });
            }, 2500);
        }

        function errorAlert() {
            $(".alert-danger").slideDown("fast");

            setTimeout(function() {
                $(".alert-danger").slideUp(500, function() {
                    $(this).hide();
                });
            }, 2500);
        }

        firebase.database().ref("info").on("value", function(data){
            var info = data.val();

            $('#db-info').html(info.txt);

            // $.each(info.state, function(index, value) {
            //     $('#inputState').append($("<option />").val(index).text(value.title));
            // });

            $.each(info.uf, function(index, value) {
                $('#inputUF').append($("<option />").val(index).text(value.title));
            });

            $.each(info.enrollment, function(index, value) {
                $('#inputEnrollment').append($("<option />").data('professional',value.professional).val(index).text(value.title));
            });

            $('#inputEnrollment').change(function(){
                var isProfessional = $(this).find(':selected').data('professional');
                if(isProfessional){
                    console.log('is prof');
                    $('.non-professional').hide();
                    $('.professional').show();
                } else {
                    $('.non-professional').show();
                    $('.professional').hide();
                }
            });

            // Poster Countdown
            countdown(info.posterDeadline, "#poster-countdown", function(){
                $("#inputPoster").attr("disabled", true);
                $('#abstract-form').hide();
                $('#abstract-view').show();
                $('#abstract fieldset').hide();
                // $("#abstractTab").addClass("disabled").click(function (e) {
                //     e.preventDefault();
                //     return false;
                // });
            });

            // Oral Countdown
            countdown(info.oralDeadline, "#oral-countdown", function(){
                $("#inputOral").attr("disabled", true);
            });

        }, function(err){
            alert(err);
        });

        //COUNTDOWN
        function countdown(deadline, selector, expire){
            var interval = setInterval(function() {

                var now = new Date().getTime();

                var distance = new Date(deadline).getTime() - now;

                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                $(selector).text(days+"d "+hours+"h "+minutes+"m "+seconds+"s");

                if (distance < 0) {
                    clearInterval(interval);
                    $(selector).text("EXPIRED");
                    expire();
                }
            }, 1000);
        }
    });

    </script>
  </body>
</html>